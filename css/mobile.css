/* =========================================
   MOBILE OPTIMIZATION - 3D Portfolio
   ========================================= 
   Breakpoints:
   - Mobile: max-width 768px
   - Small Mobile: max-width 480px
   
   Critical: No horizontal scrolling allowed
   ========================================= */

/* =========================================
   BASE MOBILE RESET
   ========================================= */
@media (max-width: 768px) {

    /* GLOBAL: Disable webkit tap highlight (blue box on click) */
    * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
    }

    /* Prevent horizontal scrolling on mobile - DO NOT constrain height */
    html,
    body {
        overflow-x: hidden !important;
        max-width: 100vw;
        /* NOTE: Do NOT set height: 100% or 100dvh here - it blocks vertical scrolling! */
    }

    * {
        max-width: 100vw;
    }

    /* =========================================
       PILL NAVIGATION - MOBILE REVAMP
       ========================================= */
    #brain-nav-menu {
        display: flex !important;
        position: fixed;
        top: auto;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        right: auto;
        padding: 12px 16px;
        width: auto;
        max-width: calc(100vw - 40px);
        border-radius: 35px;
        background: rgba(5, 9, 21, 0.95);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(0, 255, 255, 0.4);
        box-shadow:
            0 10px 40px rgba(0, 0, 0, 0.5),
            0 0 20px rgba(0, 255, 255, 0.1);
        transition: transform 0.3s ease, opacity 0.3s ease, bottom 0.4s ease;
    }

    /* Menu positioned higher on hero section (more towards middle) */
    body:not(.brain-mode-mini) #brain-nav-menu {
        bottom: 12vh;
    }

    .brain-nav-list {
        gap: 8px;
        flex-wrap: nowrap;
    }

    .brain-nav-item {
        padding: 12px 16px;
        min-width: 55px;
        min-height: 50px;
        justify-content: center;
        border-radius: 22px;
        position: relative;
        overflow: hidden;
        /* Mobile-friendly animations - vertical pulse instead of horizontal slide */
        transition:
            transform 0.15s cubic-bezier(0.4, 0, 0.2, 1),
            background 0.2s ease,
            box-shadow 0.25s ease;
    }

    /* Tap animation - scale down with glow */
    .brain-nav-item:active {
        transform: scale(0.88);
        background: rgba(0, 255, 255, 0.2);
        box-shadow:
            inset 0 0 20px rgba(0, 255, 255, 0.3),
            0 0 15px rgba(0, 255, 255, 0.4);
    }

    /* Active/selected state with subtle pulse animation */
    .brain-nav-item.active {
        background: rgba(0, 255, 255, 0.15);
        box-shadow:
            0 0 25px rgba(0, 255, 255, 0.3),
            inset 0 0 10px rgba(0, 255, 255, 0.1);
        animation: menuItemPulse 2s ease-in-out infinite;
    }

    @keyframes menuItemPulse {

        0%,
        100% {
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.25);
        }

        50% {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
        }
    }

    /* Ping effect on navigation - vertical burst instead of horizontal */
    .brain-nav-item.ping-effect::before {
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 10px;
        height: 10px;
    }

    /* Hide numbers on mobile, show only labels */
    .nav-number {
        display: none;
    }

    /* Dynamic font sizing for menu labels - more prominent */
    .nav-label {
        font-size: clamp(0.6rem, 3vw, 0.9rem);
        font-weight: 700;
        letter-spacing: 1px;
        text-transform: uppercase;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
    }

    /* =========================================
       HERO SECTION MOBILE
       ========================================= */
    /* Push header/subheader down ONLY on main nav page (not other sections) */
    body:not(.brain-mode-mini) #hero-title {
        top: 100px;
        /* Pushed further down on main nav */
        padding: 0 10px;
        max-width: 100%;
    }

    /* In mini mode (sections), use default positioning */
    body.brain-mode-mini #hero-title {
        top: 20px;
    }

    #hero-title h1 {
        font-size: clamp(1.6rem, 6vw, 2.2rem);
        /* Dynamic sizing */
        letter-spacing: 1px;
    }

    #hero-title .subtitle {
        font-size: clamp(0.75rem, 3vw, 0.95rem);
        /* Dynamic sizing */
        letter-spacing: 1px;
        margin-top: 8px;
    }

    /* Help button repositioned */
    #help-btn {
        top: 25px;
        right: 20px;
        width: 36px;
        height: 36px;
        font-size: 1rem;
    }

    /* Help tooltip - FULLY SOLID for mobile readability */
    /* High z-index to ensure it's above the brain canvas */
    #help-btn .help-tooltip {
        width: calc(100vw - 60px);
        max-width: 280px;
        right: -10px;
        z-index: 10000 !important;
        /* FULLY SOLID - no transparency at all */
        background-color: #0a1223 !important;
        background: #0a1223 !important;
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
        border: 2px solid rgba(0, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.95);
        /* Ensure no blending with elements behind */
        isolation: isolate;
        mix-blend-mode: normal;
    }

    /* CRITICAL: Disable hover state on mobile - breaks toggle */
    #help-btn:hover .help-tooltip {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
    }

    /* Mobile: Show tooltip ONLY via click toggle class (added via JS) */
    #help-btn.tooltip-visible .help-tooltip {
        opacity: 1 !important;
        visibility: visible !important;
        transform: translateY(0) !important;
        pointer-events: auto;
        background-color: #0a1223 !important;
        background: #0a1223 !important;
    }

    /* Settings button - positioned next to help button (top right) */
    #settings-btn {
        top: 25px;
        right: 65px;
        /* Next to help button */
        bottom: auto;
        width: 36px;
        height: 36px;
    }

    /* =========================================
       BRAIN CONTAINER MOBILE - CENTERED
       ========================================= */
    #brain-hero-container {
        pointer-events: auto;
        /* Lower z-index on mobile so help tooltip appears above it */
        z-index: 100 !important;
    }

    /* Ensure help button and tooltip are above brain */
    #help-btn {
        z-index: 2000000 !important;
    }

    #help-btn .help-tooltip {
        z-index: 2000001 !important;
    }

    /* Block scroll indicator when brain is being dragged */
    body.brain-dragging {
        overflow: hidden !important;
        touch-action: none;
    }

    /* Hide interaction overlay on mobile - simpler UX */
    #interaction-overlay {
        display: none;
    }

    /* =========================================
       SECTION LAYOUTS MOBILE
       ========================================= */
    .content-section {
        padding: 70px 15px;
        /* Let content determine height on mobile - no fixed min-height */
        min-height: auto;
        height: auto;
    }

    .section-content {
        max-width: 100%;
        padding: 0;
    }

    .content-section h2 {
        font-size: clamp(1.6rem, 6vw, 2.2rem);
        /* Dynamic sizing */
        letter-spacing: 2px;
        -webkit-text-stroke-width: 0.5px;
    }

    .launcher-layout {
        gap: 3vh;
    }

    .launcher-header {
        padding: 0 10px;
    }

    .launcher-tagline {
        font-size: 0.9rem;
        padding: 0 10px;
    }

    /* =========================================
       LAUNCHER GRID MOBILE (Projects/Profile)
       ========================================= */
    .launcher-grid {
        grid-template-columns: 1fr;
        gap: 15px;
        max-width: 100%;
        padding: 0 10px;
    }

    .sl-card {
        padding: 15px;
    }

    .sl-card .card-header h4 {
        font-size: 1rem;
    }

    .project-desc {
        font-size: 0.85rem;
    }

    .skill-chips {
        gap: 6px;
    }

    .skill-chips span {
        font-size: 0.7rem;
        padding: 4px 8px;
    }

    .action-hint {
        font-size: 0.75rem;
        padding: 0 10px;
    }

    /* =========================================
       EXPERIENCE TIMELINE MOBILE
       ========================================= */
    .desktop-only {
        display: none !important;
    }

    .mobile-only {
        display: block !important;
    }

    .experience-timeline-vertical {
        padding: 20px 10px;
        max-width: 100%;
    }

    .v-item {
        margin-bottom: 20px;
    }

    .v-card {
        padding: 12px;
        max-width: calc(50vw - 30px);
    }

    .v-role {
        font-size: 0.85rem;
    }

    .v-date {
        font-size: 0.7rem;
    }

    /* FIX: Center numbers properly inside circular nodes */
    .v-node {
        width: 36px;
        height: 36px;
        font-size: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        line-height: 1;
        padding: 0;
        /* Reset any padding that might offset */
    }

    /* =========================================
       SKILLS & LABS MOBILE - COMPREHENSIVE HEIGHT FIX
       ========================================= */
    /* CRITICAL: Let content fully determine section height */
    #section-skills-labs {
        min-height: auto !important;
        height: auto !important;
        padding-top: 80px;
        padding-bottom: 120px;
        overflow: visible;
    }

    #section-skills-labs .section-content,
    #section-skills-labs .skills-labs-layout {
        height: auto !important;
        min-height: auto !important;
        overflow: visible;
    }

    .skills-labs-layout {
        gap: 25px;
        display: flex;
        flex-direction: column;
    }

    .sl-content-band {
        padding: 0 10px;
        height: auto;
    }

    .sl-tabs-nav {
        gap: 6px;
        flex-wrap: nowrap;
        justify-content: center;
        padding: 0 5px;
        margin-bottom: 15px;
    }

    .sl-tab-btn {
        padding: 10px 14px;
        font-size: 0.8rem;
        min-height: 44px;
        font-weight: 600;
    }

    /* CRITICAL: Content wrapper must expand to fit content */
    .sl-tab-content-wrapper {
        min-height: auto !important;
        height: auto !important;
        overflow: visible;
    }

    /* Each tab pane needs to be height:auto */
    .sl-tab-pane {
        height: auto !important;
        min-height: auto !important;
    }

    .sl-tab-pane.active {
        display: block;
        height: auto !important;
    }

    .sl-grid-2x2 {
        grid-template-columns: 1fr;
        gap: 15px;
    }

    .interests-wrapper {
        padding: 0;
    }

    .interests-cluster {
        gap: 8px;
    }

    .interests-cluster span {
        font-size: 0.8rem;
        padding: 8px 12px;
    }

    /* =========================================
       OVERLAYS MOBILE - CRITICAL FIXES
       ========================================= */

    /* Ensure overlays appear above everything including pill menu */
    .overlay-container {
        z-index: 3000000 !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        height: 100dvh !important;
        /* Dynamic viewport height for mobile */
        overflow: hidden !important;
    }

    /* When overlay is open, lock body scroll but don't change position */
    body.no-scroll {
        overflow: hidden !important;
    }

    .gallery-header {
        padding: 12px 15px;
        flex-shrink: 0;
    }

    .gallery-branding h3 {
        font-size: 0.9rem;
    }

    #overlay-close-btn,
    #contact-close-btn {
        min-width: 44px;
        min-height: 44px;
        padding: 8px 12px;
        z-index: 10;
    }

    .overlay-body {
        flex-direction: column;
        flex: 1;
        overflow: hidden;
        min-height: 0;
    }

    .overlay-sidebar {
        flex: 0 0 auto;
        max-height: 100px;
        border-right: none;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 10px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
    }

    #overlay-project-list {
        display: flex;
        flex-direction: row;
        gap: 10px;
        overflow-x: auto;
        padding-bottom: 5px;
        -webkit-overflow-scrolling: touch;
    }

    #overlay-project-list li {
        white-space: nowrap;
        flex-shrink: 0;
    }

    /* Main scrollable content area */
    .overlay-content {
        flex: 1;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
        padding: 15px;
        min-height: 0;
    }

    .content-wrapper {
        padding: 20px 15px;
    }

    .project-header h2 {
        font-size: 1.5rem;
    }

    .project-header span {
        font-size: 0.8rem;
    }

    .tags-container {
        gap: 6px;
    }

    .tags-container span {
        font-size: 0.7rem;
        padding: 4px 8px;
    }

    .unified-body-layout {
        gap: 20px;
    }

    .details-split-row {
        flex-direction: column;
        gap: 20px;
    }

    .detail-col {
        width: 100%;
    }

    .detail-divider {
        width: 100%;
        height: 1px;
    }

    /* Contact Overlay Mobile */
    #contact-overlay .overlay-body {
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
    }

    #contact-overlay .details-split-row {
        gap: 25px;
    }

    #contact-overlay .detail-col.left {
        flex: 0 0 auto;
    }

    .contact-profile-img {
        width: 120px;
        height: 120px;
    }

    .contact-socials {
        grid-template-columns: 1fr 1fr !important;
        gap: 10px !important;
    }

    .social-card {
        padding: 15px !important;
    }

    .cyber-form input,
    .cyber-form textarea {
        font-size: 16px;
        /* Prevent iOS zoom */
    }

    /* =========================================
       SETTINGS PANEL MOBILE
       ========================================= */
    .settings-content {
        width: 100%;
        max-width: 100vw;
    }
}

/* =========================================
   SMALL MOBILE (480px and below)
   ========================================= */
@media (max-width: 480px) {
    #brain-nav-menu {
        bottom: 25px;
        padding: 8px 12px;
    }

    /* Menu positioned higher on hero section for small screens too */
    body:not(.brain-mode-mini) #brain-nav-menu {
        bottom: 10vh;
    }

    .nav-label {
        font-size: clamp(0.5rem, 3vw, 0.7rem);
    }

    #hero-title {
        top: 70px;
        /* Slightly less than tablet */
    }

    #hero-title h1 {
        font-size: clamp(1.4rem, 7vw, 1.8rem);
    }

    #hero-title .subtitle {
        font-size: clamp(0.65rem, 3.5vw, 0.85rem);
    }

    .content-section h2 {
        font-size: clamp(1.4rem, 7vw, 1.8rem);
    }

    .v-card {
        max-width: calc(50vw - 25px);
    }

    .v-role {
        font-size: 0.75rem;
    }

    /* Ensure node centering is maintained on small screens */
    .v-node {
        width: 32px;
        height: 32px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .sl-tab-btn {
        padding: 8px 10px;
        font-size: 0.7rem;
    }
}